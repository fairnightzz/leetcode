This one was interesting, my solution was O(n(n+r)log n), with space O(n+r), Essentially shortest path on every node.